SafeScreen: Система активной защиты от визуальных утечек информации

SafeScreen — это прототип программного комплекса класса Endpoint Protection, предназначенный для предотвращения несанкционированного создания снимков экрана (скриншотов) и записи видео с рабочего стола пользователя.

Проект разработан в рамках исследования методов противодействия вредоносному ПО типа InfoStealer и Spyware, эксплуатирующему технику MITRE ATT&CK T1113 (Screen Capture).

ОПИСАНИЕ ПРОБЛЕМЫ

В современном ландшафте киберугроз классические средства защиты (антивирусы, традиционные DLP) часто оказываются неэффективными против угроз визуального перехвата. Злоумышленники используют легитимные системные вызовы (API операционной системы) для получения изображения экрана, что затрудняет детекцию сигнатурными методами. Утечка конфиденциальных данных (пароли, персональные данные, коммерческая тайна) происходит в момент их отображения на мониторе пользователя, минуя файловую систему и сетевые фильтры.

АРХИТЕКТУРА И ПРИНЦИП РАБОТЫ

SafeScreen реализует концепцию "Активной защиты" (Active Defense), объединяя технологии компьютерного зрения и низкоуровневого системного программирования Windows API. Работа комплекса строится на трех этапах:

1. Оптический мониторинг (OCR & Vision)
Система в фоновом режиме анализирует содержимое активных окон приложений. Используется гибридный подход к захвату изображения:
- Высокопроизводительный захват через Desktop Duplication API (mss) для первичного анализа.
- Технология "Hybrid X-Ray": Прямое чтение буфера отрисовки окна через WinAPI PrintWindow. Это позволяет системе анализировать содержимое окна, даже если оно визуально перекрыто другими окнами или защитным оверлеем.

2. Морфологический анализ (Analyzer)
Извлеченный текстовый слой проходит через модуль семантического анализа (реализован в src/vuln_words_dict.py). В отличие от простых списков стоп-слов, система использует:
- Хеш-таблицы для поиска ключевых слов за время O(1).
- Регулярные выражения для выявления структурированных данных (номера кредитных карт, паспортные данные РФ, сложные пароли, API-ключи).
- Устойчивость к регистру и частичной обфускации.

3. Динамическая защита (Adaptive Shielding)
При обнаружении конфиденциальной информации система активирует механизм защиты:
- Создается защитное окно-оверлей (Overlay), геометрически привязанное к целевому окну (HWND).
- Оверлей использует расширенные стили окон Windows (WS_EX_LAYERED, WS_EX_TRANSPARENT, WS_EX_TOPMOST), что делает его непрозрачным для зрения и скриншотеров, но прозрачным для событий мыши и клавиатуры.
- Реализован механизм Anti-Flicker: защита удерживается в активном состоянии при кратковременных сбоях распознавания, предотвращая утечку кадров.

ТЕХНОЛОГИЧЕСКИЙ СТЕК

- Язык разработки: Python 3.10+
- Взаимодействие с ОС: Win32 API, ctypes (User32, GDI32, Dwmapi)
- Компьютерное зрение: Tesseract OCR, OpenCV (обработка изображений)
- Захват экрана: MSS (High-performance screen capture)
- Целевая платформа: Windows 10/11 (Architecture x64)

СТРУКТУРА РЕПОЗИТОРИЯ

/
|-- src/
|   |-- dlp_protection.py     # Основной модуль ядра защиты (Core logic, WinAPI wrapper)
|   |-- vuln_words_dict.py    # Модуль словаря угроз и эвристического анализа
|
|-- attack_simulation/        # Модуль имитации целевых атак (Pentest Suite)
|   |-- hacker_server.py      # C2 сервер злоумышленника (Flask)
|   |-- virus_net.py          # Агент-шпион с функцией эксфильтрации данных
|
|-- requirements.txt          # Список зависимостей проекта
|-- README.md                 # Техническая документация

МОДУЛЬ ИМИТАЦИИ АТАКИ (ATTACK SIMULATION)

Для верификации эффективности защитных механизмов в состав комплекса включен стенд, имитирующий действия вредоносного ПО. Стенд реализует архитектуру "Клиент-Сервер":

1. Агент (virus_net.py): Запускается на защищаемой машине. Выполняет периодический захват экрана в оперативной памяти (без создания файлов на диске) и отправляет данные на удаленный сервер по протоколу HTTP.
2. Сервер (hacker_server.py): Принимает входящие соединения и сохраняет полученные изображения.

Результат теста: При активной системе SafeScreen, на сервер злоумышленника поступают изображения, где конфиденциальная информация полностью перекрыта черным массивом пикселей (защитным щитом), что подтверждает предотвращение утечки.

УСТАНОВКА И ЗАПУСК

Требования:
1. ОС Windows 10/11 x64.
2. Установленный Python 3.10 или выше.
3. Установленный Tesseract OCR (путь по умолчанию: C:\Program Files\Tesseract-OCR\tesseract.exe).

Установка зависимостей:
pip install -r requirements.txt

Запуск модуля защиты:
cd src
python dlp_protection.py

Запуск имитации атаки (опционально):
1. На машине атакующего: python attack_simulation/hacker_server.py
2. На машине жертвы: настроить IP в virus_net.py и запустить python attack_simulation/virus_net.py
