# SafeScreen: Система активной защиты от визуальных утечек информации

SafeScreen — это прототип программного комплекса класса Endpoint Protection, предназначенный для предотвращения несанкционированного создания снимков экрана (скриншотов) и записи видео с экрана рабочего стола.

Проект разработан в рамках исследования методов противодействия вредоносному ПО типа InfoStealer и Spyware, эксплуатирующему технику MITRE ATT&CK T1113 (Screen Capture).

## Описание проблемы

В современном ландшафте киберугроз классические средства защиты (антивирусы, традиционные DLP) часто оказываются неэффективными против угроз визуального перехвата. Злоумышленники используют легитимные системные вызовы (API операционной системы) для получения изображения экрана, что затрудняет детекцию сигнатурными методами. Утечка конфиденциальных данных (пароли, персональные данные, коммерческая тайна) происходит в момент их отображения на мониторе пользователя.

## Принцип работы системы

SafeScreen реализует концепцию "Активной защиты" (Active Defense), объединяя технологии компьютерного зрения и низкоуровневого системного программирования. Работа комплекса строится на трех этапах:

1.  **Оптическое распознавание (OCR Monitoring):**
    Система в фоновом режиме анализирует содержимое активных окон приложений, используя движок Tesseract OCR. Проводится непрерывное сканирование текстового слоя на наличие чувствительной информации.

2.  **Морфологический анализ (Analyzer):**
    Найденный текст проходит через модуль лингвистического анализа (реализован в `vuln_words_dict.py`). В отличие от простых списков стоп-слов, система использует алгоритм генерации словоформ, учитывающий падежи русского языка, множественные числа английского языка, а также возможные ошибки распознавания и попытки обфускации (например, замена символов).

3.  **Динамическая защита (Code Injection):**
    При обнаружении угрозы система внедряется в адресное пространство целевого процесса и принудительно активирует функцию Windows API `SetWindowDisplayAffinity` с флагом `WDA_MONITOR`. Это исключает окно приложения из композиции рабочего стола при захвате, делая его абсолютно черным для любого шпионского ПО, но оставляя видимым для пользователя.

## Технологический стек

* **Язык разработки:** Python 3.x
* **Взаимодействие с ОС:** Win32 API, ctypes, Pymem (для манипуляций с памятью процессов)
* **Компьютерное зрение:** Tesseract OCR, OpenCV, MSS (High-performance screen capture)
* **Целевая платформа:** Windows 10/11 (Architecture x64)

## Структура репозитория (на данный момент)

* `vuln_words_dict.py` — Модуль синхронизированного словаря угроз. Содержит класс SynchronizedOCRDLP, отвечающий за генерацию морфологических вариаций ключевых слов и классификацию данных по уровням критичности (от Level 1 до Level 5).
* `tmp/` — Директория с экспериментальными скриптами и модулями, находящимися в стадии активной разработки и отладки (включая модуль инъекции).

## Установка и запуск

Для корректной работы системы требуется установленный в системе Tesseract OCR.

1.  Клонирование репозитория:
    git clone https://github.com/AntonyNegr/safescreen.git

2.  Установка зависимостей:
    pip install pymem pywin32 mss numpy opencv-python pytesseract

3.  Настройка Tesseract:
    Убедитесь, что путь к исполняемому файлу tesseract.exe добавлен в переменные среды или указан в конфигурации скрипта.

