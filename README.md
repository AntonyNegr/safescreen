# SafeScreen: Система активной защиты от визуальных утечек информации

**SafeScreen** — это прототип программного комплекса класса Endpoint Protection, предназначенный для предотвращения несанкционированного создания снимков экрана (скриншотов) с рабочего стола пользователя.

Проект разработан для защиты от вредоносных программ-шпионов, которые крадут информацию путем создания скрытых снимков экрана с рабочего стола.

## Суть проблемы

Классические антивирусы часто оказываются бессильны против программ, делающих скриншоты. Это происходит потому, что вирусы используют для захвата экрана те же стандартные функции Windows, что и легальные программы (например, для записи видеозвонков или создания скриншотов). Из-за этого антивирус не видит в их действиях ничего подозрительного.

В результате, любая конфиденциальная информация — будь то пароли, паспортные данные или финансовые отчеты — становится уязвимой в самый незащищенный момент: когда она просто открыта на мониторе пользователя.

## Принцип работы системы

SafeScreen реализует концепцию **"Активной защиты" (Active Defense)**, объединяя технологии компьютерного зрения и низкоуровневого системного программирования. Работа комплекса строится на трех этапах:

### 1. Оптическое распознавание (OCR Monitoring)
Система в фоновом режиме анализирует содержимое активных окон приложений, используя движок **Tesseract OCR**. Проводится непрерывное сканирование текстового слоя на наличие чувствительной информации.

### 2. Морфологический анализ (Analyzer)
Найденный текст проходит через модуль лингвистического анализа (реализован в `src/vuln_words_dict.py`). В отличие от простых списков стоп-слов, система использует алгоритм генерации словоформ, учитывающий:
* Падежи русского языка.
* Множественные числа английского языка.
* Возможные ошибки распознавания и попытки обфускации (например, замена символов).

### 3. Динамическая защита (Code Injection & Overlay)
При обнаружении угрозы система активирует защиту, используя функции Windows API. Целевое окно перекрывается специальным слоем (Overlay), который имеет атрибут `WS_EX_TOPMOST` и прозрачен для событий ввода, но непрозрачен для визуального захвата. Это делает данные невидимыми для шпионского ПО, но доступными для работы пользователя (в случае использования `SetWindowDisplayAffinity`) или полностью скрытыми при фиксации угрозы.

## Технологический стек

* **Язык разработки:** Python 3.10+
* **Взаимодействие с ОС:** Win32 API, ctypes (User32, GDI32, Dwmapi)
* **Компьютерное зрение:** Tesseract OCR, OpenCV
* **Захват экрана:** MSS (High-performance screen capture)
* **Целевая платформа:** Windows 10/11 (Architecture x64)

## Структура репозитория

* `src/dlp_protection.py` — Основной модуль ядра защиты. Реализует логику сканирования, управления окнами и взаимодействия с Tesseract.
* `src/vuln_words_dict.py` — Модуль синхронизированного словаря угроз. Содержит класс `SynchronizedOCRDLP`, отвечающий за классификацию данных по уровням критичности.
* `attack_simulation/` — Директория со стендом для тестирования (C2 Server и Spyware Agent).

## Установка

Для корректной работы системы требуется установленный в системе **Tesseract OCR**.

### 1. Установка Tesseract
Убедитесь, что Tesseract OCR установлен и путь к исполняемому файлу (`tesseract.exe`) соответствует конфигурации в скрипте (по умолчанию: `C:\Program Files\Tesseract-OCR\tesseract.exe`).

### 2. Установка зависимостей
Выполните команду в корневой директории проекта:

```bash
pip install -r requirements.txt
